df$node1_scale = df$node1_scale - min(df$node1_scale) + 1e-09
df$SVI_scale = scale(df$SVI)
df$SVI_scale = df$SVI_scale - min(df$SVI_scale) + 1e-09
df$population_scale = scale(df$population)
df$population_scale = df$population_scale - min(df$population_scale) + 1e-09
df$hwm_scale = scale(df$hwm)
df$hwm_scale = df$hwm_scale - min(df$hwm_scale) + 1e-09
df$wind_50_up_scale = scale(df$wind_50_up)
df$wind_50_up_scale = df$wind_50_up_scale - min(df$wind_50_up_scale) + 1e-09
lm_model <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model)
plot(lm_model)
lm_model <- lm(assisstance_rate_type1_scale^(0.1818182) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
summary(lm_model)
plot(lm_model)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_2 <- lm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
summary(lm_model_2)
plot(lm_model_2)
lmer_model <- lmer(assisstance_rate_type1_scale^(0.181818) ~  SVI_scale + population_scale + hwm_scale + wind_50_up_scale + node1_scale + ( 1 + hwm_scale + wind_50_up_scale + node1_scale | event_name), data = df, REML = FALSE)
summary(lmer_model)
plot(lmer_model)
qqnorm(resid(lmer_model))
qqline(resid(lmer_model))
r.squaredGLMM(lmer_model)
lmer_model <- lmer(assisstance_rate_type1_scale^(0.181818) ~  SVI_scale + population_scale + hwm_scale + wind_50_up_scale + node1_scale + ( 1 + hwm_scale + wind_50_up_scale + node1_scale | SS_scale), data = df, REML = FALSE)
summary(lmer_model)
plot(lmer_model)
qqnorm(resid(lmer_model))
qqline(resid(lmer_model))
r.squaredGLMM(lmer_model)
lmer_model <- lmer(assisstance_rate_type1_scale^(0.181818) ~  SVI_scale + population_scale + hwm_scale + wind_50_up_scale + node1_scale + ( 1 + hwm_scale + wind_50_up_scale + node1_scale | SS_scale), data = df, REML = FALSE)
summary(lmer_model)
plot(lmer_model)
qqnorm(resid(lmer_model))
qqline(resid(lmer_model))
r.squaredGLMM(lmer_model)
lmer_model <- lmer(assisstance_rate_type1_scale^(0.181818) ~  SVI_scale + population_scale + hwm_scale + wind_50_up_scale + node1_scale + ( 1 + hwm_scale + wind_50_up_scale + node1_scale | SS_scale), data = df, REML = FALSE)
summary(lmer_model)
plot(lmer_model)
qqnorm(resid(lmer_model))
qqline(resid(lmer_model))
r.squaredGLMM(lmer_model)
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(readxl)
library(dplyr)
library(patchwork)
library(tidyverse)
library(reshape2)
library(ggrepel)
library(MASS)
library(glmnet)
library(spdep)
library(lme4)
library(MuMIn)
library(car)
library(graphics)
library(bcmixed)
library(sf)
library(FNN)
library(patchwork)
library(mapview)
library(sp)
library(spdep)
library(ggmap)
library(geosphere)
library(spatialreg)
coords <- df1[, c("longtitude", "latitude")]
library(spatialreg)
coords <- df1[, c("longtitude", "latitude")]
df1 = df[df$SS_scale == 0 | df$SS_scale == 1 | df$SS_scale == 2|  df$SS_scale == 3,]
df2 = df[df$SS_scale == 4 | df$SS_scale == 5 ,]
library(spatialreg)
coords <- df1[, c("longtitude", "latitude")]
df1 = df[df$SS_scale == 0 | df$SS_scale == 1 | df$SS_scale == 2|  df$SS_scale == 3,]
df2 = df[df$SS_scale == 4 | df$SS_scale == 5 ,]
mapview(df1, xcol = "longtitude", ycol = "latitude", legend = TRUE, crs = 4269, grid = FALSE, layer3.name = "wind_duration_IDA")
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(readxl)
library(dplyr)
library(patchwork)
library(tidyverse)
library(reshape2)
library(ggrepel)
library(MASS)
library(glmnet)
library(spdep)
library(lme4)
library(MuMIn)
library(car)
library(graphics)
library(bcmixed)
library(sf)
library(FNN)
library(patchwork)
library(mapview)
library(sp)
library(spdep)
library(ggmap)
library(geosphere)
data_all = read.csv("Data_all.csv")
nrow(data_all)
df = data.frame(assisstance_rate_type1 = data_all$assisstance_rate_type1, assisstance_rate_type2 = data_all$assisstance_rate_type2, population = data_all$population, wind_50_up = data_all$wind_50_up, hwm = data_all$hwm, SVI = data_all$SVI, node1 = data_all$node1, event_name = data_all$event_name, SS_scale = data_all$SS_scale,SS_scale2 = data_all$SS_scale2, longtitude = data_all$longitude, latitude = data_all$latitude)
df$assisstance_rate_type1 = exp(df$assisstance_rate_type1) / (1 + exp(df$assisstance_rate_type1))
df$assisstance_rate_type2 = exp(df$assisstance_rate_type2) / (1 + exp(df$assisstance_rate_type2))
df$assisstance_rate_type1_scale = scale(df$assisstance_rate_type1, center = TRUE, scale = TRUE)
df$assisstance_rate_type1_scale = df$assisstance_rate_type1_scale - min(df$assisstance_rate_type1_scale) + 1e-09
df$assisstance_rate_type2_scale = scale(df$assisstance_rate_type2, center = TRUE, scale = TRUE)
df$assisstance_rate_type2_scale = df$assisstance_rate_type2_scale - min(df$assisstance_rate_type2_scale) + 1e-09
df$node1_scale = scale(df$node1, center = TRUE, scale = TRUE)
df$node1_scale = df$node1_scale - min(df$node1_scale) + 1e-09
df$SVI_scale = scale(df$SVI, center = TRUE, scale = TRUE)
df$SVI_scale = df$SVI_scale - min(df$SVI_scale) + 1e-09
df$population_scale = scale(df$population, center = TRUE, scale = TRUE)
df$population_scale = df$population_scale - min(df$population_scale) + 1e-09
df$hwm_scale = scale(df$hwm, center = TRUE, scale = TRUE)
df$hwm_scale = df$hwm_scale - min(df$hwm_scale) + 1e-09
df$wind_50_up_scale = scale(df$wind_50_up, center = TRUE, scale = TRUE)
df$wind_50_up_scale = df$wind_50_up_scale - min(df$wind_50_up_scale) + 1e-09
p1 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(event_name)))
p2 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(event_name)))
p3 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(event_name)))
p4 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(event_name)))
p5 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(event_name)))
p1 + p2 + p3 + p4 + p5
lm_model_1 <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale^(0.1818182) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
summary(lm_model_2)
plot(lm_model_2)
selected_model_1 = step(lm_model_1, direction = "both")
summary(selected_model_1)
selected_model_2 = step(lm_model_2, direction = "both")
summary(selected_model_2)
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=node1_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=population_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale2)))
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(readxl)
library(dplyr)
library(patchwork)
library(tidyverse)
library(reshape2)
library(ggrepel)
library(MASS)
library(glmnet)
library(spdep)
library(lme4)
library(MuMIn)
library(car)
library(graphics)
library(bcmixed)
library(sf)
library(FNN)
library(patchwork)
library(mapview)
library(sp)
library(spdep)
library(ggmap)
library(geosphere)
data_all = read.csv("Data_all.csv")
nrow(data_all)
df = data.frame(assisstance_rate_type1 = data_all$assisstance_rate_type1, assisstance_rate_type2 = data_all$assisstance_rate_type2, population = data_all$population, wind_50_up = data_all$wind_50_up, hwm = data_all$hwm, SVI = data_all$SVI, node1 = data_all$node1, event_name = data_all$event_name, SS_scale = data_all$SS_scale,SS_scale2 = data_all$SS_scale2, longtitude = data_all$longitude, latitude = data_all$latitude)
df$assisstance_rate_type1 = exp(df$assisstance_rate_type1) / (1 + exp(df$assisstance_rate_type1))
df$assisstance_rate_type2 = exp(df$assisstance_rate_type2) / (1 + exp(df$assisstance_rate_type2))
df$assisstance_rate_type1_scale = scale(df$assisstance_rate_type1, center = TRUE, scale = TRUE)
df$assisstance_rate_type1_scale = df$assisstance_rate_type1_scale - min(df$assisstance_rate_type1_scale) + 1e-09
df$assisstance_rate_type2_scale = scale(df$assisstance_rate_type2, center = TRUE, scale = TRUE)
df$assisstance_rate_type2_scale = df$assisstance_rate_type2_scale - min(df$assisstance_rate_type2_scale) + 1e-09
df$node1_scale = scale(df$node1, center = TRUE, scale = TRUE)
df$node1_scale = df$node1_scale - min(df$node1_scale) + 1e-09
df$SVI_scale = scale(df$SVI, center = TRUE, scale = TRUE)
df$SVI_scale = df$SVI_scale - min(df$SVI_scale) + 1e-09
df$population_scale = scale(df$population, center = TRUE, scale = TRUE)
df$population_scale = df$population_scale - min(df$population_scale) + 1e-09
df$hwm_scale = scale(df$hwm, center = TRUE, scale = TRUE)
df$hwm_scale = df$hwm_scale - min(df$hwm_scale) + 1e-09
df$wind_50_up_scale = scale(df$wind_50_up, center = TRUE, scale = TRUE)
df$wind_50_up_scale = df$wind_50_up_scale - min(df$wind_50_up_scale) + 1e-09
p1 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(event_name)))
p2 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(event_name)))
p3 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(event_name)))
p4 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(event_name)))
p5 = ggplot(df,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(event_name)))
p1 + p2 + p3 + p4 + p5
lm_model_1 <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale^(0.1818182) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df)
summary(lm_model_2)
plot(lm_model_2)
selected_model_1 = step(lm_model_1, direction = "both")
summary(selected_model_1)
selected_model_2 = step(lm_model_2, direction = "both")
summary(selected_model_2)
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=node1_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=population_scale)) + geom_point(aes(colour = factor(SS_scale2)))
ggplot(df,aes(y=assisstance_rate_type1_scale^(0.1818182),x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale2)))
df_1 = df[df$SS_scale == 0 | df$SS_scale == 1 | df$SS_scale == 2|  df$SS_scale == 3,]
df_2 = df[df$SS_scale == 4 | df$SS_scale == 5 ,]
p1 = ggplot(df_1,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
p2 = ggplot(df_1,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
p3 = ggplot(df_1,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
p4 = ggplot(df_1,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
p5 = ggplot(df_1,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
p1 + p2 + p3 + p4 + p5
p1 = ggplot(df_2,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
p2 = ggplot(df_2,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
p3 = ggplot(df_2,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
p4 = ggplot(df_2,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
p5 = ggplot(df_2,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
p1 + p2 + p3 + p4 + p5
lm_model_1 <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_1)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_1)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_1)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_1)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_1)
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_1)
summary(lm_model_2)
plot(lm_model_2)
selected_model_1 = step(lm_model_1, direction = "both")
summary(selected_model_1)
selected_model_2 = step(lm_model_2, direction = "both")
summary(selected_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale^(0.3030303) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2)
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale^(0.2222222) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2)
summary(lm_model_2)
plot(lm_model_2)
selected_model_1 = step(lm_model_1, direction = "both")
summary(selected_model_1)
selected_model_2 = step(lm_model_2, direction = "both")
summary(selected_model_2)
df_2_1 = df[df$SS_scale == 0,]
df_2_2 = df[df$SS_scale == 1 | df$SS_scale == 2 | df$SS_scale == 3,]
df_2_3 = df[df$SS_scale == 4 | df$SS_scale == 5,]
p1 = ggplot(df_2_1,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
p2 = ggplot(df_2_1,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
p3 = ggplot(df_2_1,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
p4 = ggplot(df_2_1,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
p5 = ggplot(df_2_1,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
p1 + p2 + p3 + p4 + p5
p1 = ggplot(df_2_2,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
p2 = ggplot(df_2_2,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
p3 = ggplot(df_2_2,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
p4 = ggplot(df_2_2,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
p5 = ggplot(df_2_2,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
p1 + p2 + p3 + p4 + p5
p1 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
p2 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
p3 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
p4 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
p5 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
p1 + p2 + p3 + p4 + p5
p1 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=wind_50_up_scale)) + geom_point(aes(colour = factor(SS_scale)))
p2 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=node1_scale)) + geom_point(aes(colour = factor(SS_scale)))
p3 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=SVI_scale)) + geom_point(aes(colour = factor(SS_scale)))
p4 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=population_scale)) + geom_point(aes(colour = factor(SS_scale)))
p5 = ggplot(df_2_3,aes(y=assisstance_rate_type1_scale,x=hwm_scale)) + geom_point(aes(colour = factor(SS_scale)))
p1 + p2 + p3 + p4 + p5
lm_model_1 <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_1)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_1)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_1)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_1)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale^(0.02020202) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_1)
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale^(0.02020202) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_1)
summary(lm_model_2)
plot(lm_model_2)
selected_model_1 = step(lm_model_1, direction = "both")
summary(selected_model_1)
selected_model_2 = step(lm_model_2, direction = "both")
summary(selected_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_2)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_2)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_2)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_2)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_2)
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale^(0.1818182) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_2)
summary(lm_model_2)
plot(lm_model_2)
selected_model_1 = step(lm_model_1, direction = "both")
summary(selected_model_1)
selected_model_2 = step(lm_model_2, direction = "both")
summary(selected_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_3)
bc <- boxcox(assisstance_rate_type1_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_3)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_3)
bc <- boxcox(assisstance_rate_type2_scale ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_3)
bc$x[which(bc$y == max(bc$y))]
summary(lm_model_2)
plot(lm_model_2)
lm_model_1 <- lm(assisstance_rate_type1_scale^(0.3030303) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_3)
summary(lm_model_1)
plot(lm_model_1)
lm_model_2 <- lm(assisstance_rate_type2_scale^(0.2222222) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df_2_3)
summary(lm_model_2)
plot(lm_model_2)
selected_model_1 = step(lm_model_1, direction = "both")
summary(selected_model_1)
selected_model_2 = step(lm_model_2, direction = "both")
summary(selected_model_2)
df1 = df[df$SS_scale == 0 | df$SS_scale == 1 | df$SS_scale == 2|  df$SS_scale == 3,]
df2 = df[df$SS_scale == 4 | df$SS_scale == 5 ,]
mapview(df1, xcol = "longtitude", ycol = "latitude", legend = TRUE, crs = 4269, grid = FALSE, layer3.name = "wind_duration_IDA")
mapview(df2, xcol = "longtitude", ycol = "latitude", legend = TRUE, crs = 4269, grid = FALSE, layer3.name = "wind_duration_IDA")
library(spatialreg)
coords <- df1[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df1, listw = W)
View(w)
View(coords)
library(spatialreg)
coords <- df1[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df1, listw = W)
library(spatialreg)
coords <- df[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df1, listw = W)
library(spatialreg)
coords <- df[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df, listw = W)
library(spatialreg)
coords <- df[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df, listw = W)
library(spatialreg)
coords <- df[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df, listw = W)
library(spatialreg)
coords <- df1[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df1, listw = W)
library(spatialreg)
coords <- df1[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale0","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
View(df_1)
library(spatialreg)
coords <- df1[, c("longtitude", "latitude","assisstance_rate_type1_scale")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
library(spatialreg)
coords <- df1[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
View(coords)
library(spatialreg)
coords_temp <- df1[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
dupes <- duplicated(cbind(coords_temp$longtitude, coords_temp$latitude))
coords_temp <- coords_temp[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
library(spatialreg)
coords_temp <- df1[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
dupes <- duplicated(cbind(coords_temp$longtitude, coords_temp$latitude))
coords_temp <- coords_temp[!dupes, ]
coords <- df1[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords_temp <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::lagsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df1, listw = W)
summary(model)
library(spatialreg)
coords_temp <- df1[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
dupes <- duplicated(cbind(coords_temp$longtitude, coords_temp$latitude))
coords_temp <- coords_temp[!dupes, ]
coords <- df1[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords_temp <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::errorsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df1, listw = W)
summary(model)
library(spatialreg)
coords_temp <- df[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
dupes <- duplicated(cbind(coords_temp$longtitude, coords_temp$latitude))
coords_temp <- coords_temp[!dupes, ]
coords <- df[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords_temp <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::errorsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = df1, listw = W)
library(spatialreg)
coords_temp <- df[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
dupes <- duplicated(cbind(coords_temp$longtitude, coords_temp$latitude))
coords_temp <- coords_temp[!dupes, ]
coords <- df[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords_temp <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::errorsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = coords_temp, listw = W)
View(coords_temp)
View(coords)
library(spatialreg)
coords_temp <- df[, c("longtitude", "latitude","assisstance_rate_type1_scale","node1_scale","SVI_scale","population_scale","hwm_scale","wind_50_up_scale")]
dupes <- duplicated(cbind(coords_temp$longtitude, coords_temp$latitude))
coords_temp <- coords_temp[!dupes, ]
coords <- df[, c("longtitude", "latitude")]
dupes <- duplicated(cbind(coords$longtitude, coords$latitude))
coords <- coords[!dupes, ]
w <- knn2nb(knearneigh(coords, k = 5, longlat = TRUE))
W <- nb2listw(w, style="W", zero.policy=TRUE)
model <- spatialreg::errorsarlm(assisstance_rate_type1_scale^(0.1414141) ~ node1_scale + SVI_scale + population_scale + hwm_scale + wind_50_up_scale, data = coords_temp, listw = W)
summary(model)
